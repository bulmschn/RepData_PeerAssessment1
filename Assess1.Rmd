Reproducible Research Peer Assesment 1
========================================================
## Loading and Preprocessing the data

First read in the files and get the total number of steps per day: 

```{r}
library(plyr)
library(reshape2)
library(ggplot2)

unzip("activity.zip")
act <- read.csv("activity.csv")

totalSteps <- tapply(act$steps, act$date, FUN = sum)
totalSteps <- melt(totalSteps)
names(totalSteps) <- c("date", "totalSteps")
```


###Calculating the mean total number of steps per day

Part one of the assignment
- Make a histogram of the total number of steps 
- Calculate the mean and median of the total number of steps per day


```{r}
ggplot(totalSteps, aes(x = totalSteps) ) + geom_bar() + labs(title = "Histogram of total number of steps per day")

summary(totalSteps)
#gives you values for mean and median
```

###What is the average daily activity pattern? 

Reaggregate the data using the reshape package to summarize the data by interval and plot with the ggplot package because it makes prettier plots than base R.. 
```{r}
m.act <- melt(act, measure = "steps", id = c("date", "interval"), na.rm = TRUE)
byInt <- dcast(m.act, interval ~ variable, fun = mean)
ggplot(byInt, aes(x = interval, y = steps)) + geom_line()

```

The interval in which steps has the max value of 206.1698 is at 835. The code below finds the max values and then displays the row containing the max value of steps. 

```{r}
maxId = which(byInt$steps == max(byInt$steps))
byInt[maxId,]
```

###Imputing missing values 

1. There are 2304 missing values, as caluclated below.
```{r}
nas = act$steps[is.na(act$steps)]
length(nas)
```
2. The strategy I took to impute missing values is to take the average for each time interval and replace this missing value using the ave() function 
3. The new dataset is act2
```{r}
act2 <- act
act2 <- transform(act2, 
            steps = ifelse(is.na(steps),
            ave(steps, interval, FUN = function(x) mean(x, na.rm = TRUE)),  steps))
```
4. Histogram of the total values with the new data  (again using ggplot because it makes nicer plots)

```{r}

totalSteps2 <- tapply(act2$steps, act2$date, FUN = sum)
totalSteps2 <- melt(totalSteps2)
names(totalSteps2) <- c("date", "totalSteps")
#this is the same as for non-imputed values
ggplot(totalSteps2, aes(x = totalSteps) ) + geom_bar() + labs(title = "Histogram of total number of steps per day")
summary(totalSteps2)

```

If you comapre mean and median before and after imputing missing values, only the median changed, and only by 1. 

###Comparing Weekdays to weekends 
1. New variable for weekday vs. weekend is called wkOrwkend
```{r}
act2$date <- as.Date(act2$date)
act2$day = weekdays(act2$date)
act2$wkOrwkend = ifelse(!(act2$day %in% c("Saturday", "Sunday")), "weekday", "weekend")

```
2. Plot, using ggplot 

```{r}
ggplot(act2, aes(x= interval, y= steps )) + geom_line() + facet_grid(~wkOrwkend)
```